function [w1, w2, w3] = barycentric(v1, v2, v3, v)
    denom = (v2(2) - v3(2)) * (v1(1) - v3(1)) + ...
        (v3(1) - v2(1)) * (v1(2) - v3(2));
    
    w1 = ((v2(2) - v3(2)) * (v(1) - v3(1)) + (v3(1) - v2(1)) * (v(2) - v3(2))) / denom;
    w2 = ((v3(2) - v1(2)) * (v(1) - v3(1)) + (v1(1) - v3(1)) * (v(2) - v3(2))) / denom;
    w3 = 1 - w1 - w2;
